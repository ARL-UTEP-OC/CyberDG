
<!-- Modal -->

<div class="modal fade" id="uploadModal" tabindex="-1" role="dialog" aria-labelledby="uploadModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <!-- todo: add action to the form-->
    <form class="form" id="uploadForm" action="{{url_for('file_upload')}}" method="POST" enctype="multipart/form-data">
      <div class="modal-content">
        <div class="modal-header text-center">
          <h5 class="modal-title w-100" id="uploadModalLabel">Upload</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="card card-modal">
            <!--Upload type starts-->
            <div class="form-group">
              <div class="input-group mb-3">
                <div class="input-group-prepend">
                  <label class="input-group-text" for="uploadType">Upload Type: </label>
                </div>
                <select class="custom-select" id="uploadType" placeholder="Choose..." name="upload_type" required>
                  <option value="vuln">Vulnerability</option>
                  <option value="pov">Exploit</option>
                </select>
                <div class="invalid-feedback">Please fill out this field.</div>
              </div>
            </div>
            <!--end of Upload Type-->
            <!--Upload name starts-->
            <div class="form-group">
              <label for="upload_name"> Upload Name: </label>
              <input type="text" class="form-control" id="upload_name" placeholder="Enter Upload Name..." name="upload_name" required>
              <div class="invalid-feedback">Please fill out this field.</div>
            </div>
            <!--Upload name ends-->
            <div class="form-group">
              <label for="description"> File Description: </label>
              <textarea class="form-control" rows="3" id="description" name="description" placeholder="Enter File Description... " required></textarea>
              <div class="invalid-feedback">Please fill out this field.</div>
            </div>
            <!--cve # starts-->
            <div class="form-group">
              <label for="upload_name"> CVE #: </label>
              <input type="text" class="form-control" placeholder="Ex:2020-0796 (Optional)" name="cve_number" />
            </div>

            <div class="form-group">
              <label for="browseFile"> Browse: </label>
              <input type="file" class="form-control" id="browserFile" placeholder="..." name="file" required>
              <div class="valid-feedback">Valid.</div>
              <div class="invalid-feedback">Please fill out this field.</div>
            </div>
            <!--Hidden file hash field-->
            <div class="form-group">
              <input type="hidden" class="form-control" vaue="hash" name="hash" required>
            </div>
            <!--Hidden file hash field-->
            <!--Hidden file id field-->
            <div class="form-group">
              <input type="hidden" class="form-control" value="id" name="id" required>
            </div>
            <!--Hidden file hash field-->
          </div>
        </div>
        <div class="modal-footer justify-content-center">
          <button type="submit" class="btn btn-primary" id="uploadButton"><i class="fas fa-upload"></i> Upload</button>
        </div>
      </div>
    </form>
  </div>
</div>



<script>
 //Script to avoid to show error messages before input text
  $("#uploadButton").click(function(event) {
      var form = $("#uploadForm");
      if (form[0].checkValidity() === false) {
        event.preventDefault();
        event.stopPropagation();
      }
      form.addClass('was-validated');
  });
</script>
